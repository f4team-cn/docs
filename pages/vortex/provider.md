# Vortex çš„æ‰©å±•å¼€å‘

## âš™ï¸ å®ç°åŸç†

Vortex çš„æ‰©å±•ç³»ç»ŸåŸºäº **Electron æ¶æ„** å’Œ **æ’ä»¶éš”ç¦»æœºåˆ¶**ï¼Œæ•´ä½“æµç¨‹å¦‚ä¸‹ï¼š

```text
Vortex Application
       â”‚
       â–¼
 new Electron.BrowserWindow
       â”‚  åˆ›å»ºç‹¬ç«‹çª—å£åŠ è½½æ‰©å±•
       â–¼
 loadProviderPage
       â”‚  åŠ è½½æ‰©å±•å‰ç«¯é¡µé¢ï¼ˆHTML / JS / CSSï¼‰
       â–¼
 exposeApi
       â”‚  å‘æ‰©å±•æš´éœ² Vortex æä¾›çš„ API
       â–¼
 æ‰©å±•é€šè¿‡ API ä¸ä¸»åº”ç”¨äº¤äº’
```

### è¯¦ç»†è§£é‡Š

1. **Vortex Application**
   ä¸»åº”ç”¨å¯åŠ¨ï¼Œåˆå§‹åŒ–æ ¸å¿ƒæ¨¡å—ï¼ŒåŒ…æ‹¬ä¸‹è½½ç®¡ç†ã€ä»»åŠ¡è°ƒåº¦å’Œ UI æ¡†æ¶ã€‚

2. **new Electron.BrowserWindow**
   ä¸ºæ¯ä¸ªæ‰©å±•åˆ›å»ºç‹¬ç«‹çš„ **BrowserWindow**ï¼Œä¿è¯è¿è¡Œç¯å¢ƒéš”ç¦»ï¼Œå¹¶æ”¯æŒè‡ªå®šä¹‰çª—å£å¤§å°ã€å›¾æ ‡ç­‰ã€‚

3. **loadProviderPage**
   æ‰©å±•çš„å‰ç«¯é¡µé¢é€šè¿‡æ­¤æ–¹æ³•åŠ è½½åˆ° BrowserWindow ä¸­ï¼Œé¡µé¢å¯ä»¥æ˜¯æœ¬åœ° HTML æ–‡ä»¶æˆ–æ‰“åŒ…å¥½çš„ JS/CSSã€‚

4. **exposeApi**
   ä¸»è¿›ç¨‹é€šè¿‡ Electron çš„ `contextBridge.exposeInMainWorld` æˆ– `ipcRenderer` å‘æ‰©å±•æ³¨å…¥ APIï¼Œå¸¸ç”¨æ¥å£ç¤ºä¾‹ï¼š

| API           | åŠŸèƒ½        | æè¿°                  |
|---------------|-----------|---------------------|
| `$http`       | HTTP è¯·æ±‚   | ç”¨äºå‘é€ GET / POST ç­‰è¯·æ±‚ |
| `$__store`    | Vortex é…ç½® | è®¿é—® Vortex çš„é…ç½®æ•°æ®     |
| `$__electron` | ç³»ç»Ÿå±‚ API   | æä¾›ç³»ç»Ÿç›¸å…³æ“ä½œ            |

> æ‰©å±•å¼€å‘è€…åº”é€šè¿‡è¿™äº› API ä¸ Vortex ä¸»åº”ç”¨äº¤äº’ï¼Œè€Œä¸è¦ç›´æ¥è®¿é—®ä¸»è¿›ç¨‹ï¼Œä»¥ç¡®ä¿å®‰å…¨æ€§ã€‚

## ğŸ›  å¼€å‘å®æˆ˜

## ğŸ“„ æ‰©å±•é…ç½®æ–‡ä»¶

æ‰©å±•å¿…é¡»åŒ…å«ä¸€ä¸ª `provider.json` æ–‡ä»¶ï¼Œç”¨äºæè¿°æ‰©å±•çš„åŸºæœ¬ä¿¡æ¯å’Œè¿è¡Œå‚æ•°ã€‚

::: code-group

```json [provider.json]
{
  "id": "test-provider",
  "name": "ä»»åŠ¡æ‰©å±•",
  "description": "è¿™æ˜¯ä¸€ä¸ªä»»åŠ¡æ‰©å±•",
  "author": "Yingyya",
  "version": [
    1,
    0,
    1
  ],
  "index": "index.html",
  "window": [
    400,
    650
  ]
}
```

:::

### å­—æ®µè¯´æ˜

| å­—æ®µ              | ç±»å‹                         | è¯´æ˜                                 | ç¤ºä¾‹                | é»˜è®¤å€¼          |
|-----------------|----------------------------|------------------------------------|-------------------|--------------|
| **id**          | `string`                   | æ‰©å±•å”¯ä¸€ IDï¼Œåœ¨ç”¨æˆ·å·²å®‰è£…æ‰©å±•ä¸­å¿…é¡»å”¯ä¸€              | `"test-provider"` | â€”            |
| **name**        | `string`                   | æ‰©å±•åç§°                               | `"ä»»åŠ¡æ‰©å±•"`          | â€”            |
| **description** | `string`                   | æ‰©å±•ç®€ä»‹                               | `"è¿™æ˜¯ä¸€ä¸ªä»»åŠ¡æ‰©å±•"`      | â€”            |
| **author**      | `string`                   | æ‰©å±•ä½œè€…                               | `"Yingyya"`       | â€”            |
| **version**     | `[number, number, number]` | æ‰©å±•ç‰ˆæœ¬ï¼Œéµå¾ªè¯­ä¹‰åŒ–ç‰ˆæœ¬å·ï¼ˆmajor, minor, patchï¼‰ | `[1, 0, 1]`       | `[1,0,0]`    |
| **index**       | `string`                   | æ‰©å±•å…¥å£æ–‡ä»¶ï¼Œç›¸å¯¹æ‰©å±•ç›®å½•è·¯å¾„                    | `"index.html"`    | â€”            |
| **window**      | `[number, number]`         | æ‰©å±•çª—å£å¤§å°ï¼Œæ ¼å¼ `[å®½, é«˜]`                 | `[400, 650]`      | `[400, 650]` |

## ğŸŒ å‰ç«¯å·¥å…·é“¾æ”¯æŒ

Vortex æ‰©å±•å¼€å‘æ”¯æŒç°ä»£å‰ç«¯å·¥å…·é“¾ï¼Œå¼€å‘è€…å¯ä»¥æ ¹æ®è‡ªå·±çš„æŠ€æœ¯æ ˆé€‰æ‹©åˆé€‚çš„å·¥å…·è¿›è¡Œå¼€å‘ã€‚

### ä½¿ç”¨ Vite æ„å»ºæ‰©å±•

Vite æ˜¯ä¸€ä¸ªç°ä»£åŒ–çš„å‰ç«¯æ„å»ºå·¥å…·ï¼Œå…·æœ‰å¿«é€Ÿçš„å†·å¯åŠ¨å’Œçƒ­æ›´æ–°åŠŸèƒ½ã€‚è¦ä½¿ç”¨ Vite æ„å»º Vortex æ‰©å±•ï¼š

1. åˆå§‹åŒ– Vite é¡¹ç›®ï¼š

::: code-group

```bash [npm]
npm create vite@latest my-extension -- --template vanilla
cd my-extension
npm install
```

:::

2. é…ç½® `vite.config.js` ä»¥é€‚é… Vortex æ‰©å±•ï¼š
::: code-group

```js [vite.config.js]
import { defineConfig } from 'vite';
import { resolve } from 'path';

export default defineConfig({
   build: {
      rollupOptions: {
         input: {
            main: resolve(__dirname, 'index.html')
         }
      }
   }
});
```

:::
3. å¼€å‘å®Œæˆåï¼Œæ„å»ºé¡¹ç›®ï¼š
::: code-group

```bash [npm]
npm run build
```

:::

4. å°†ç”Ÿæˆçš„ `dist` ç›®å½•å†…å®¹å¤åˆ¶åˆ°æ‰©å±•ç›®å½•ï¼Œå¹¶ç¡®ä¿ `provider.json` ä¸­çš„ `index` å­—æ®µæŒ‡å‘æ­£ç¡®çš„å…¥å£æ–‡ä»¶ã€‚

### ä½¿ç”¨ Webpack æ„å»ºæ‰©å±•

Webpack æ˜¯ä¸€ä¸ªå¼ºå¤§çš„æ¨¡å—æ‰“åŒ…å·¥å…·ï¼Œé€‚ç”¨äºå¤æ‚çš„å‰ç«¯é¡¹ç›®ã€‚è¦ä½¿ç”¨ Webpack æ„å»º Vortex æ‰©å±•ï¼š

1. åˆå§‹åŒ–é¡¹ç›®å¹¶å®‰è£… Webpackï¼š
::: code-group

```bash [npm]

npm init -y
npm install webpack webpack-cli --save-dev
```

:::

2. é…ç½® `webpack.config.js`ï¼š
::: code-group

```javascript [webpack.config.js]

const path = require('path');
module.exports = {
  entry: './src/index.js',
  output: {
    filename: 'bundle.js',
    path: path.resolve(__dirname, 'dist')
  }
};
```

:::

3. æ„å»ºé¡¹ç›®ï¼š
::: code-group

```bash [npm]
npx webpack --mode production
```

:::

4. å°†ç”Ÿæˆçš„ `dist` ç›®å½•å†…å®¹å¤åˆ¶åˆ°æ‰©å±•ç›®å½•ï¼Œå¹¶é…ç½® `provider.json`ã€‚

### æ³¨æ„äº‹é¡¹

- ç¡®ä¿æ„å»ºåçš„æ–‡ä»¶ç»“æ„ç¬¦åˆ Vortex æ‰©å±•çš„è¦æ±‚ã€‚
- åœ¨ä½¿ç”¨å‰ç«¯æ¡†æ¶æ—¶ï¼Œæ³¨æ„ä¸ Vortex æä¾›çš„ API è¿›è¡Œé›†æˆã€‚
- æµ‹è¯•æ‰©å±•åœ¨ Vortex ç¯å¢ƒä¸­çš„è¡¨ç°ï¼Œç¡®ä¿åŠŸèƒ½æ­£å¸¸ã€‚

## ğŸ§© ä½¿ç”¨ Vortex API

Vortex ä¸ºä¸»è¿›ç¨‹å’Œæ‰©å±•ä¹‹é—´æä¾›äº†å®‰å…¨çš„é€šä¿¡æœºåˆ¶ã€‚åœ¨æ‰©å±•ä¸­ï¼Œæ‚¨å¯ä»¥é€šè¿‡é¢„å®šä¹‰çš„ API ä¸ä¸»åº”ç”¨è¿›è¡Œäº¤äº’ã€‚
Vortex æä¾›çš„ API å‡æš´éœ²åœ¨ Windows ä¸­ï¼Œè¯¦æƒ…è¯·å‚è€ƒ [Vortex API æ–‡æ¡£](/vortex/provider-api)ã€‚

### æ³¨æ„äº‹é¡¹

- è¿™äº› API åªèƒ½åœ¨æ‰©å±•çš„å‰ç«¯ä»£ç ä¸­ä½¿ç”¨ï¼Œä¸èƒ½åœ¨ä¸»è¿›ç¨‹ä¸­ç›´æ¥è°ƒç”¨ã€‚
- ä¸ºäº†å®‰å…¨èµ·è§ï¼Œä¸è¦åœ¨æ‰©å±•ä¸­æš´éœ²è¿™äº› API ç»™ä¸å—ä¿¡ä»»çš„ä»£ç ã€‚
- åœ¨ä½¿ç”¨ API æ—¶ï¼Œå»ºè®®æ·»åŠ é”™è¯¯å¤„ç†æœºåˆ¶ä»¥æé«˜æ‰©å±•çš„ç¨³å®šæ€§ã€‚

---